# 🏪 黑龙江门店数据分析平台

一个基于Streamlit和Folium的交互式门店数据分析和可视化平台。

## 功能特性

- 📊 **数据概览**：显示门店总数、平均卖力值、覆盖城市等关键指标
- 🗺️ **地理分布地图**：使用Folium展示门店在地图上的位置，支持按渠道类型颜色分类
- 🔍 **多维度筛选**：支持按城市、渠道、城市级别和卖力值范围进行筛选
- 📈 **数据统计图表**：包含渠道分布饼图、城市级别分布柱状图、卖力值分布直方图
- 📋 **详细数据表格**：展示筛选后的门店详细信息
- 📥 **数据导出**：支持将筛选后的数据导出为CSV文件

## 环境要求

- Python 3.7+
- 依赖包见 `requirements.txt`

## 安装和运行

1. 安装依赖包：
```bash
pip install -r requirements.txt
```

2. 确保Excel数据文件在项目根目录：
```
黑龙江数据V20250609.xlsx
```

3. 启动应用：
```bash
streamlit run streamlit_app.py
```

4. 在浏览器中打开：
```
http://localhost:8501
```

## 数据字段说明

该平台支持包含以下字段的Excel数据：

- **门店基础信息**：门店编码、门店名称
- **地理位置信息**：大区、省、市、区县、乡镇、村/街道、地址、经度、纬度
- **业务分类信息**：城市级别、一级渠道、所属连锁系统
- **评估指标**：网点状态名称、渠道高潜排名、卖力值、宝洁SEQ

## 地图功能

- 🔴 **红色标记**：MM渠道门店
- 🔵 **蓝色标记**：Grocery渠道门店
- 🟢 **绿色标记**：CVS渠道门店
- 🟠 **橙色标记**：HSM渠道门店
- 标记大小根据卖力值调整
- 点击标记可查看门店详细信息
- 支持热力图图层（可切换）

## 界面说明

1. **侧边栏筛选器**：
   - 城市选择
   - 渠道类型选择
   - 城市级别选择
   - 卖力值范围滑块

2. **主要指标卡片**：
   - 门店总数及占比
   - 平均卖力值对比
   - 覆盖城市数量
   - 覆盖区县数量

3. **地图展示区**：
   - 全屏地图显示
   - 交互式门店标记
   - 图例说明

4. **统计图表区**：
   - 渠道分布饼图
   - 城市级别分布柱状图
   - 卖力值分布直方图

5. **数据表格区**：
   - 详细门店信息表格
   - 数据导出功能

## 技术栈

- **Streamlit**：Web应用框架
- **Folium**：地图可视化
- **Plotly**：交互式图表
- **Pandas**：数据处理
- **OpenPyXL**：Excel文件读取

## 版本信息

- 数据版本：V20250609
- 平台版本：1.0.0 